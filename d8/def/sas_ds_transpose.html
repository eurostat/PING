<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PING: ds_transpose</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ping_bw.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PING
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Statistical data handling and processing in production environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d8/def/sas_ds_transpose.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ds_transpose </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Tanspose many variables in a multiple-row-per-subject table to a one-row-per-subject table</p>
<div class="fragment"><div class="line">%ds_transpose(idsn, odsn, var=, by=, pivot=, copy=, missing=no, numeric=no, ilib=WORK, olib=WORK, llib=WORK);</div></div><!-- fragment --><h3>Arguments</h3>
<ul>
<li><code>idsn</code> : name of the input dataset;</li>
<li><code>var</code> : lists of variables to be transposed;</li>
<li><code>by</code> : name of the variable(s) that identifies(y) a subject;</li>
<li><code>pivot</code> : (<em>option</em>) name of the variable from input dataset for which each row value should lead to series of variables (one series per variable listed in <code>var</code>, above) in output dataset; when passed, there should be only one variable named in pivot argument; when empty, a common <code>PROC TRANSPOSE</code> is applied;</li>
<li><code>copy</code> : (<em>option</em>) list of variables that occur repeatedly with each observation for a subject and will be copied to the resulting dataset; default: not taken into account;</li>
<li><code>missing</code> : (<em>option</em>) boolean flag (<code>yes/no</code>) set to keep (<code>no</code>) or drop (<code>yes</code>) the observations that correspond to a missing value in pivot from the input dataset before transposing; default: <code>missing=no</code>;</li>
<li><code>numeric</code> : (<em>option</em>) boolean flag (<code>yes/no</code>) set to replace the observed character string value for variable used as pivot (when it is indeed a string variable) by numbers as suffixes in transposed variable names or not; default: <code>numeric=no</code> (<em>i.e.</em> character string values observed in pivot variable will be used as suffixes in new variable names); this is relevant only when pivot variable is literal;</li>
<li><code>ilib</code> : (<em>option</em>) name of the input library; by default: empty, <em>i.e.</em> <code>WORK</code> is used;</li>
<li><code>olib</code> : (<em>option</em>) name of the output library; by default: empty, <em>i.e.</em> the value of <code>ilib</code> will be used;</li>
<li><code>llib</code> : (<em>option</em>) name of the library where value labels are defined (if any variables of interest in the input dataset were categorical/attached value labels); by default: empty, <em>i.e.</em> <code>WORK</code> is used.</li>
</ul>
<h3>Returns</h3>
<ul>
<li><code>odsn</code> : name of the output dataset.</li>
</ul>
<h3>Examples</h3>
<p>We provide here the examples already used in the original code (see note below).</p>
<p>Given the table <code>dsn</code> in <code>WORK</code>ing library ("example1"): </p><table class="doxtable">
<tr>
<th>centre </th><th>subjectno </th><th>gender </th><th>visit </th><th>sbp </th><th>wt  </th></tr>
<tr>
<td>1 </td><td>1 </td><td>female </td><td>A </td><td>121.667 </td><td>75.4 </td></tr>
<tr>
<td>1 </td><td>1 </td><td>female </td><td>baseline</td><td>120 </td><td>75 </td></tr>
<tr>
<td>1 </td><td>1 </td><td>female </td><td>week 1 </td><td>125 </td><td>75.5 </td></tr>
<tr>
<td>1 </td><td>1 </td><td>female </td><td>week 4 </td><td>120 </td><td>75.7 </td></tr>
<tr>
<td>1 </td><td>2 </td><td>male </td><td>A </td><td>142.5 </td><td>71.5 </td></tr>
<tr>
<td>1 </td><td>2 </td><td>male </td><td>baseline</td><td>140 </td><td>70 </td></tr>
<tr>
<td>1 </td><td>2 </td><td>male </td><td>week 1 </td><td>145 </td><td>73 </td></tr>
<tr>
<td>2 </td><td>1 </td><td>female </td><td>A </td><td>153.333 </td><td>90.6667 </td></tr>
<tr>
<td>2 </td><td>1 </td><td>female </td><td>baseline</td><td>155 </td><td>90 </td></tr>
<tr>
<td>2 </td><td>1 </td><td>female </td><td>week 1 </td><td>150 </td><td>90.8 </td></tr>
<tr>
<td>2 </td><td>1 </td><td>female </td><td>week 4 </td><td>155 </td><td>91.2 </td></tr>
</table>
<p>then running:</p>
<div class="fragment"><div class="line">%ds_transpose(dsn, out, var=sbp wt, by=centre subjectno, pivot=visit);</div></div><!-- fragment --><p> will set the output table <code>out</code> to: </p><table class="doxtable">
<tr>
<th>centre</th><th>subjectno</th><th>sbpA </th><th>wtA </th><th>sbpbaseline</th><th>wtbaseline</th><th>sbpweek_1</th><th>wtweek_1</th><th>sbpweek_4</th><th>wtweek_4  </th></tr>
<tr>
<td>1 </td><td>1 </td><td>121.667</td><td>75.4 </td><td>120 </td><td>75 </td><td>125 </td><td>75.5 </td><td>120 </td><td>75.7 </td></tr>
<tr>
<td>1 </td><td>2 </td><td>142.5 </td><td>71.5 </td><td>140 </td><td>70 </td><td>145 </td><td>73 </td><td>. </td><td>. </td></tr>
<tr>
<td>2 </td><td>1 </td><td>153.333</td><td>90.6667</td><td>155 </td><td>90 </td><td>150 </td><td>90.8 </td><td>155 </td><td>91.2 </td></tr>
</table>
<p>and running:</p>
<div class="fragment"><div class="line">%ds_transpose(dsn, out, var=sbp wt, by=centre subjectno, pivot=visit, copy=gender);</div></div><!-- fragment --><p> will set the output table <code>out</code> to: </p><table class="doxtable">
<tr>
<th>vcentre</th><th>subjectno</th><th>sbpA </th><th>wtA </th><th>sbpbaseline</th><th>wtbaseline</th><th>sbpweek_1</th><th>wtweek_1</th><th>sbpweek_4</th><th>wtweek_4</th><th>gender  </th></tr>
<tr>
<td>1 </td><td>1 </td><td>121.667</td><td>75.4 </td><td>120 </td><td>75 </td><td>125 </td><td>75.5 </td><td>120 </td><td>75.7 </td><td>female </td></tr>
<tr>
<td>1 </td><td>2 </td><td>142.5 </td><td>71.5 </td><td>140 </td><td>70 </td><td>145 </td><td>73 </td><td>. </td><td>. </td><td>male </td></tr>
<tr>
<td>2 </td><td>1 </td><td>153.333</td><td>90.6667</td><td>155 </td><td>90 </td><td>150 </td><td>90.8 </td><td>155 </td><td>91.2 </td><td>female </td></tr>
</table>
<p>Run macro <code>%_example_ds_transpose</code> for examples.</p>
<h3>Notes</h3>
<ol type="1">
<li><b>The macro <code>%ds_transpose</code> is a wrapper to L. Joseph's original <code>%MultiTranspose</code> macro</b>. Original source code (no license, no disclaimer) is available at <a href="http://www.medicine.mcgill.ca/epidemiology/joseph/pbelisle/multitranspose.html">http://www.medicine.mcgill.ca/epidemiology/joseph/pbelisle/multitranspose.html</a>.</li>
<li>This macro transposes multiple variables in a dataset as if multiple calls to <code>PROC TRANSPOSE</code> were performed. Indeed, it is useful when data need to be restructured from a multiple-row-per-subject structure into a one-row-per-subject structure. While when only one variable needs to be transposed, <code>PROC TRANSPOSE</code> can perform the task directly, the same operation may be time consuming when two or more variables need to be transposed, since it is then necessary to transpose each variable separately and then merge the transposed datasets.</li>
<li>The following conditions need to be satisfied:<ul>
<li>a column used as a pivot cannot have any duplicate values for a given series of values found in <code>by</code> variables,</li>
<li><code>copy</code> variables have the same values within each series of <code>by</code> values.</li>
</ul>
</li>
<li>Use the following options:<ul>
<li><code>numeric=yes</code> to use numbers as suffixes in transposed variable names rather than characters,</li>
<li><code>missing=yes</code> if you'd rather not drop observations where variable defined as pivot has a missing value.</li>
</ul>
</li>
</ol>
<h3>References</h3>
<ol type="1">
<li>Stuelpner, J. (2006): <a href="http://www2.sas.com/proceedings/sugi31/234-31.pdf">"The TRANPOSE procedure or how to turn it Around"</a>.</li>
<li>Zdeb, M. (2006): <a href="http://www.lexjansen.com/nesug/nesug06/hw/hw09.pdf">"An introduction to reshaping (TRANSPOSE) and combining (MATCH-MERGE) SAS datasets"</a>.</li>
<li>Conway, T. (2008): <a href="http://www2.sas.com/proceedings/forum2008/089-2008.pdf">"It's a bird, it's a plane, it's SQL TRANSPOSE!"</a>.</li>
<li>Zirbel, D. (2009): <a href="http://support.sas.com/resources/papers/proceedings09/060-2009.pdf">"Learn the basics of PROC TRANSPOSE"</a>.</li>
<li>Tabachneck, A.S., Shan, X.K., Virgile, R. and Whitehurst, J. (2013) : <a href="http://support.sas.com/resources/papers/proceedings13/538-2013.pdf">"A better way to flip (transpose) a SAS dataset"</a>.</li>
</ol>
<h3>See also</h3>
<p><a href="http://support.sas.com/documentation/cdl/en/proc/61895/HTML/default/viewer.htm#a000063661.htm">PROC TRANSPOSE</a>, <a href="http://www.medicine.mcgill.ca/epidemiology/joseph/pbelisle/multitranspose.html">MultiTranspose</a>, <a href="http://www.sascommunity.org/mwiki/images/3/37/Transpose_Macros_MAKEWIDE_and_MAKELONG.sas">MAKEWIDE/MAKELONG</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d4/d6f/library_dataset.html">Dataset manipulation</a></li>
    <li class="footer">Generated on Fri Jan 12 2018 11:50:17 for PING by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
