<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PING: Aggregates</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../ping_bw.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PING
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Statistical data handling and processing in production environment</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d7/d7b/group___aggregates.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Aggregates</div>  </div>
</div><!--header-->
<div class="contents">
<p>Legacy _"EUVALS"_-based code that calculates _(i)_ the EU aggregate of _(ii)_ an indicator _(iii)_ during a given year, possibly imputing data for missing countries from past years.</p>
<div class="fragment"><div class="line">%silc_agg_compute(geo, time, idsn, odsn, ctrylst=,</div><div class="line">            max_yback=0, thr_min=0.7, thr_cum=0, agg_only=yes, force_Nwgh=NO, </div><div class="line">            ilib=WORK, olib=WORK, pdsn=META_POPULATIONxCOUNTRY, plib=G_PING_LIBCFG);</div></div><!-- fragment --><h3>Arguments</h3>
<ul>
<li><code>geo</code> : a given geographical area, <em>e.g.</em> EU28, EA, ...;</li>
<li><code>time</code> : year of interest;</li>
<li><code>idsn</code> : name of the dataset storing the indicator for which an aggregated value is estimated over the <code>geo</code> area and during the <code>time</code> year;</li>
<li><code>ctrylst</code> : (<em>option</em>) list of (blank-separated, no quote) strings representing the ISO-codes of all the countries supposed to belong to <code>geo</code>; when not provided, it is automatically determined from <code>geo</code> and <code>time</code> (see macro <a class="el" href="../../d3/db0/sas_zone_to_ctry.html">%zone_to_ctry</a>);</li>
<li><code>max_yback</code> : (<em>option</em>) number of years used for imputation of missing data; it tells how to look backward in time, <em>i.e.</em> consider the <code>max_yback</code> years prior to the estimated; default: <code>max_yback=0</code>, <em>i.e.</em> only data available for current year shall be considered; <code>max_yback</code> can also be set to <code>_ALL_</code> so as to take all available data from the input dataset, whatever the year considered: in that case, the other argument(s) normally used for building the list of countries (see below: <code>thr_min</code>) are ignored; default: <code>max_yback=0</code> (<em>i.e.</em>, only current year);</li>
<li><code>thr_min</code> : (<em>option</em>) value (in range [0,1]) of the threshold used to test whether currently (<em>i.e.</em> for the year <code>time</code> under investigation): available population [time] / global population [time] &gt;= <code>thr_min</code> ? default: <code>thr_min=0.7</code>, <em>i.e.</em> the available population should be at least 70% of the global population of the <code>geo</code> area;</li>
<li><code>thr_cum</code>: (<em>option</em>) value (in range [0,1]) of the threshold used to test the cumulated available population, <em>i.e.</em> whether: available population [&amp;time-&amp;maxyback,time] / global population [time] &gt;= <code>thr_cum</code> ? default: <code>thr_cum=0</code>, <em>i.e.</em> there is no further test on the cumulated population once the <code>thr_min</code> test on currently available population is passed;</li>
<li><code>grpdim</code> : (<em>option</em>) list (blank separated, no comma) of dimensions used by the indicator; if not set (default), it is retrieved automatically from the input table using <a class="el" href="../../de/db7/sas_ds_contents.html">%ds_contents</a> and considering the standard format of EU-SILC tables (see also <a class="el" href="../../d6/dde/sas_silc_ind_create.html">%silc_ind_create</a>);</li>
<li><code>agg_only</code> : (<em>option</em>) boolean flag (<code>yes/no</code>) set to keep in the output table the aggregate <code>geo</code> only; when set to <code>no</code>, then all data used for the aggregate estimation are kept in the output table <code>odsn</code> (see below); default: <code>agg_only=yes</code>, <em>i.e.</em> only the aggregate will be stored in <code>odsn</code>;</li>
<li><code>flag</code> : (<em>option</em>) who knows...?</li>
<li><code>mode</code> : (<em>option</em>) flag (char) setting the mode of data output; it is either <code>UPDATE</code> (<em>e.g.</em>, for primary RDB indicators, default) or <code>INSERT</code> (<em>e.g.</em>, for secondary RDB2 indicators);</li>
<li><code>force_Nwgh</code> : (<em>option</em>) additional boolean flag (<code>yes/no</code>) set when an additional variable <code>nwgh</code> (representing the weighted sample) is present in the output dataset; used in <code>EUvals</code> , where this option is not foreseen in the original <code>EUvals</code> implementation; default: <code>force_Nwgh=no</code>;</li>
<li><code>pdsn</code> : (<em>option</em>) name of the dataset storing total populations per country; default: <code>META_POPULATIONxCOUNTRY</code>;</li>
<li><code>plib</code> : (<em>option</em>) name of the library storing the population dataset <code>pdsn</code>; default: <code>plib</code> is associated to the folder <code>G_PING_LIBCFG</code> folder commonly used to store this file;</li>
<li><code>ilib</code> : (<em>option</em>) input dataset library; default (not passed or ' '): <code>ilib=WORK</code>.</li>
</ul>
<h3>Returns</h3>
<ul>
<li><code>odsn</code> : (generic) name of the output datasets; two tables are actually created: the table <code>odsn</code> will store all the calculations with the aggregated indicator;</li>
<li><code>CTRY_&amp;odsn</code> : this table will also store, for each country, the year of extraction of data for the calculation of aggregates in year <code>time</code> will also be created; for instance for a given calculated at <code>time=2015</code>, where BG data are missing until 2013, CY data until 2014, DE data until 2012, ES until 2014, etc..., this table will look like: <table class="doxtable">
<tr>
<th>geo </th><th>time  </th></tr>
<tr>
<td>AT </td><td>2015 </td></tr>
<tr>
<td>BE </td><td>2015 </td></tr>
<tr>
<td>BG </td><td>2013 </td></tr>
<tr>
<td>CY </td><td>2014 </td></tr>
<tr>
<td>CZ </td><td>2015 </td></tr>
<tr>
<td>DE </td><td>2012 </td></tr>
<tr>
<td>DK </td><td>2015 </td></tr>
<tr>
<td>EE </td><td>2015 </td></tr>
<tr>
<td>EL </td><td>2015 </td></tr>
<tr>
<td>ES </td><td>2014 </td></tr>
<tr>
<td>.. </td><td>.... </td></tr>
</table>
</li>
<li><code>olib</code> : (<em>option</em>) output dataset library; default (not passed or ' '): <code>olib=WORK</code>.</li>
</ul>
<h3>Example</h3>
<p>Run macro <code>%_example_silc_agg_compute</code>.</p>
<h3>Notes</h3>
<ol type="1">
<li>The computed aggregate is not inserted into the input dataset <code>idsn</code> but in the output <code>odsn</code> dataset passed as an argument. If you want to actually update the input dataset, you will need to explicitely call for it. For instance, say you want to calculate the 2016 EU28 aggregate of <code>PEPS01</code> indicator from the so-called <code>rdb</code> library:</li>
</ol>
<div class="fragment"><div class="line">%silc_agg_compute(EU28, 2016, PEPS01, &amp;odsn, ilib=rdb, olib=WORK);</div><div class="line">DATA rdb.PEPS01;</div><div class="line">    SET rdb.PEPS01(WHERE=(not(time=2016 and geo=EU28))) </div><div class="line">        WORK.PEPS01; </div><div class="line">run;</div><div class="line">%work_clean(PEPS01);</div></div><!-- fragment --><ol type="1">
<li>For that reason, the datasets <code>idsn</code> and <code>odsn</code> must be different!</li>
</ol>
<h3>References</h3>
<ol type="1">
<li>World Bank <a href="http://data.worldbank.org/about/data-overview/methodologies">aggregation rules</a>.</li>
<li>Eurostat <a href="http://ec.europa.eu/eurostat/statistics-explained/index.php/Category:Geography_glossary">geography glossary</a>.</li>
</ol>
<h3>See also</h3>
<p><a class="el" href="../../de/dbf/sas_silc_euvals.html">%silc_EUvals</a>, <a class="el" href="../../db/d23/sas_silc_agg_process.html">%silc_agg_process</a>, <a class="el" href="../../d9/d94/sas_ctry_select.html">%ctry_select</a>, <a class="el" href="../../d3/db0/sas_zone_to_ctry.html">%zone_to_ctry</a>, <a class="el" href="../../de/d95/sas_var_to_list.html">%var_to_list</a>, <a class="el" href="../../de/db7/sas_ds_contents.html">%ds_contents</a>. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jan 12 2018 09:16:03 for PING by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
